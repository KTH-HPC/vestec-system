version: '3'
services:
  nginx:
    container_name: nginx
    build:
      context: ../Nginx
      dockerfile: Dockerfile
    ports:
      - "80:80"
      - "443:443"
    volumes:
      - "/var/vestec/certs:/var/vestec/certs"

  website:
    container_name: website
    build:
      context: ../
      dockerfile: website/Dockerfile
    environment:
      VESTEC_MANAGER_URI: "http://manager:5500/jobs"
    env_file:
      - environment_variables.env

  manager:
    container_name: manager
    depends_on:
      - "maria"
    build:
      context: ../
      dockerfile: SimulationManager/Dockerfile
    #WE ONLY NEED THIS IF WE ARE USING SQLITE
    # volumes:
    #   - "../Database:/database"
    env_file:
      - environment_variables.env

  maria:
    container_name: mariadb
    image: mariadb
    environment:
      MYSQL_ROOT_PASSWORD: "changeme"
    volumes:
      - "/var/vestec/db:/var/lib/mysql"
